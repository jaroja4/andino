<!DOCTYPE html>
<html lang="en">

<head>
    <!-- check User session -->
    <script src="vendors/jquery/dist/jquery.min.js"></script>
    <script src="assets/js/session.min.js"></script>
    <script>
        session.check();
    </script>
    <!-- /End check -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>StoryLabs | Facturación</title>

    <!-- Bootstrap -->
    <link href="vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="vendors/nprogress/nprogress.min.css" rel="stylesheet">
    <!-- Bootstrap.Select -->
    <link href="vendors/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="vendors/iCheck/skins/flat/green.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="assets/css/custom.min.css" rel="stylesheet">
    <!-- CSS -->
    <link href="assets/css/facturacion.css" rel="stylesheet">
    <!-- validate
    <link href="assets/css/fv.css" rel="stylesheet"> -->
    <!-- Switchery -->
    <link href="vendors/switchery/dist/switchery.min.css" rel="stylesheet">
    <!-- Datatables -->
    <link href="vendors/datatables.net/datatables.min.css" rel="stylesheet">
    <!-- SweetAlert -->
    <link href="vendors/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- ajaxLoading -->
    <!-- <link href="assets/css/ajaxLoad.css" rel="stylesheet"> -->

</head>

<body class="nav-md">
    <div class="container body">
        <div class="main_container" style="visibility:hidden">
            <div class="col-md-3 left_col">
                <div class="left_col scroll-view">
                    <div class="navbar nav_title" style="border: 0;">
                        <a href="http://storylabscr.com" class="site_title">
                            <i class="glyphicon glyphicon-share-alt"></i>
                            <span>StoryLabs CR</span>
                        </a>
                    </div>

                    <div class="clearfix"></div>

                    <!-- menu profile quick info -->
                    <div class="profile clearfix">
                        <div class="profile_pic">
                            <img src="images/user.png" alt="..." class="img-circle profile_img">
                        </div>
                        <div class="profile_info">
                            <span>Bienvenido,</span>
                            <h2 id='call_name'></h2>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <!-- /menu profile quick info -->

                    <br />
                    <!-- sidebar menu -->
                    <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                        <div class="menu_section">
                            <h3>General</h3>
                            <ul class="nav side-menu">
                                <li>
                                    <a>
                                        <i class="fa fa-home"></i> home
                                        <span class="fa fa-chevron-down"></span>
                                    </a>
                                    <ul class="nav child_menu">
                                        <li>
                                            <!-- <a href="index.html">Inicio</a> -->
                                        </li>
                                        <li>
                                            <a href="dashboard.html">Resumen</a>
                                        </li>
                                        <li>
                                            <!-- <a href="inventario.html">Inventario</a> -->
                                        </li>
                                        <li>
                                            <a href="listaFacturas.html">Lista de Facturas</a>
                                        </li>

                                        <li>
                                            <a href="facturacion.html">Facturación</a>
                                        </li>
                                        <li>
                                            <a href="mensajeReceptor.html">Aceptar Comprobantes</a>
                                        </li>
                                        <li>
                                            <a href="contribuyente.html">Contribuyente</a>
                                        </li>
                                        <li>
                                            <a href="email.html">Correo Electrónico</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- /sidebar menu -->

                    <!-- /menu footer buttons -->
                    <div class="sidebar-footer hidden-small">
                        <!-- <a data-toggle="tooltip" data-placement="top" title="Settings">
                            <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
                        </a>
                        <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                            <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
                        </a>
                        <a data-toggle="tooltip" data-placement="top" title="Lock">
                            <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
                        </a> -->
                        <a data-toggle="tooltip" data-placement="top" title="Cerrar Sesión" onclick="session.end();">
                            <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                        </a>
                    </div>
                    <!-- /menu footer buttons -->
                </div>
            </div>

            <!-- top navigation -->
            <div class="top_nav">
                <div class="nav_menu">
                    <nav>
                        <div class="nav toggle">
                            <a id="menu_toggle">
                                <i class="fa fa-bars"></i>
                            </a>
                        </div>

                        <ul class="nav navbar-nav navbar-right">
                            <li class="">
                                <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" id='call_username'
                                    aria-expanded="false">
                                    <img src="images/user.png" alt="">Usuario
                                    <span class=" fa fa-angle-down"></span>
                                </a>
                                <ul class="dropdown-menu dropdown-usermenu pull-right">
                                    <li>
                                        <a id="btn_OpenModalConfiguracion">
                                            <i class="fa fa-cogs pull-right"></i> Configurar
                                        </a>
                                    </li>
                                    <li>
                                        <a onclick="session.end();">
                                            <i class="fa fa-sign-out pull-right"></i> Cerrar Sesión</a>
                                    </li>
                                </ul>
                            </li>

                        </ul>
                    </nav>
                </div>
            </div>
            <!-- /top navigation -->

            <!-- page content -->
            <div class="right_col" role="main">
                <div class="page-title">
                    <div class="title_left">
                        <!-- <h3 class='call_idDocumento'>...</h3> -->
                    </div>
                    <div class="title_right">
                        <h3 id="fecha" style="float:right"></h3>
                    </div>
                </div>

                <div class="clearfix"></div>

                <!-- CONTENIDO DE LA FACTURA -->
                <div class="row">
                    <div class="col-xs-12 col-md-12 col-lg-12">
                        <div class="x_panel">
                            <div class="x_content">

                                <div class="row">
                                    <div class="col-xs-12 col-md-12 col-lg-12 ">
                                        <!-- / producto o servicio: debería etiquetar el tipo de impuesto que está presentando. / -->
                                        <label class="control-label col-xs-12 col-md-12 col-lg-12 call_clasificacion" for="inp_descripcion"
                                            id="clasificacion" value="producto">Producto</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-xs-12 col-md-12 col-lg-9">
                                        <div class="validar_agregar espacioInferior">
                                            <input id="inp_descripcion" type="text" class="form-control" placeholder="Descripción"
                                                autofocus>
                                        </div>
                                    </div>

                                    <div class="col-xs-12 col-md-12 col-lg-2 validar_agregar espacioInferior">
                                        <input id="inp_precio" type="number" min="1" max="9999999999" step="1" class="form-control modImporte"
                                            placeholder="Precio/U">
                                    </div>

                                    <div class="col-xs-12 col-md-12 col-lg-1 espacioInferior">
                                        <div class="input-group">
                                            <button id="btn_agregarProducto" class="btn btn-default" type="button"
                                                disabled>Agregar</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12 col-xs-12 col-lg-12">
                                        <table id="prd" class="table display responsive table-striped jambo_table no-wrap"
                                            role="grid" aria-describedby="datatable_info">
                                            <tbody id="productos">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-10 col-sm-7 col-md-6 col-lg-4 col-xl-4  subtotales">
                                        <div class="x_content">
                                            <div class="table-responsive">
                                                <table class="table table-striped jambo_table bulk_action">
                                                    <tbody>
                                                        <tr class="even pointer">
                                                            <td class="">SubTotal</td>
                                                            <td class=""> </td>
                                                            <td class="" id="subtotal">¢0</td>
                                                        </tr>
                                                        <!-- <tr class="odd pointer">
                                                                    <td class="">Descuento</td>
                                                                    <td class="" id="desc_100">0%</td>
                                                                    <td class="" id="desc_val">¢0</td>
                                                                </tr> -->
                                                        <tr class="even pointer">
                                                            <td class="">Impuesto de Ventas</td>
                                                            <td class="text-left" id="iv_100">13% </td>
                                                            <td class="" id="iv_val">¢0</td>
                                                        </tr>
                                                        <tr class="odd pointer danger" style="font-size:20px">
                                                            <td class="">TOTAL</td>
                                                            <td class=""></td>
                                                            <td class="" id="total">¢0</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <!-- FIN DEL CONTENIDO -->

                <div class="clearfix"></div>

                <div class="ln_solid"></div>

                <div class="form-group">
                    <div class="col-xs-12 col-md-12 col-lg-12">
                        <button type="submit" class="btn btn-primary" id="reload">Limpiar</button>
                        <button type="button" id="btn_open_modal_agregar_cliente" onclick="btn_open_modal_agregar_cliente()"
                            class="btn btn-warning disableBTN">Receptor 
                            <span class="badge badge-info">F4</span>
                        </button>
                        <button type="button" class="btn btn-success" id="btn_open_modal_fac">Continuar
                            <span class="badge badge-info">F2</span>
                        </button>
                    </div>
                </div>
            </div>
            <!-- /page content -->

            <!-- footer content -->
            <footer>
                <div class="pull-right">                    
                    <a href="http://storylabscr.com">Powerd by Story Labs</a>
                </div>
                <div class="clearfix"></div>
            </footer>
            <!-- /footer content -->
        </div>
    </div>

    <!-- modals Facturar tipo de pago -->
    <!-- Large modal Facturar tipo de pago -->
    <div class="modal fade factura-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content modal-factura">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">X</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">Facturar</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div>
                            <center>
                                <h1 id="total_pagar"></h1>
                            </center>

                        </div>
                    </div>
                    <div class="row">
                        <div id="formapago">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div id="btn-formapago">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- modals -->
    <!-- Large modal -->

    <!-- modals Facturar Cliente -->
    <!-- Large modal Seleccionar o insertar Cliente -->
    <div class="modal fade seleccionar-cliente-modal-lg" data-backdrop="static" data-keyboard="false" tabindex="-1"
        role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" id="btn_Cerrar_seleccionar-cliente-modal-lg" class="close" data-dismiss="modal">
                        <span aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">Cliente</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="input-group">
                                <input id="lbl_cedulaReceptor" type="text" class="form-control" placeholder="Buscar por Cedula">
                                <span class="input-group-btn">
                                    <button id="btn_buscarReceptor" class="btn btn-default" type="button">Buscar</button>
                                </span>
                            </div><!-- /input-group -->
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <!-- /////////////////////////////////////////////////////// 
                                        Inicio de Form Cliente
                        /////////////////////////////////////////////////////// -->
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel">
                                <div class="x_title">
                                    <div class="clearfix"></div>
                                </div>

                                <!--  CONTENIDO DE LA PAGINA -->
                                <div class="x_content">
                                    <form class="form-horizontal form-label-left" id="frm" novalidate>

                                        <div class="title_left">
                                            <h3>Cliente</h3>
                                        </div>

                                        <!-- <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="empresa">Agencia/Empresa
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="empresa" class="form-control col-md-7 col-xs-12 call_"
                                                    data-validate-length-range="10,80" name="empresa" type="text"
                                                    autofocus>
                                            </div>
                                        </div> -->

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="nombre">Nombre
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="nombre" class="form-control col-md-7 col-xs-12"
                                                    data-validate-length-range="10,80" name="nombre" required="required"
                                                    type="text" placeholder="Nombre completo">
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="idTipoIdentificacion">Tipo
                                                Identificacion
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <select class="selectpicker show-menu-arrow form-control" type="select"
                                                    required="required" id="idTipoIdentificacion" name="idTipoIdentificacion"></select>
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="identificacion">Identificación
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="identificacion" class="form-control col-md-7 col-xs-12"
                                                    pattern="([0-9]){9,9}" data-validate-length-range="9,9" name="identificacion"
                                                    required="required" type="text" placeholder="9 digitos, sin cero al inicio y sin guiones.">
                                            </div>
                                            <span id="checkIdentificacion" class="fa"></span>
                                        </div>


                                        <div class="ln_solid"></div>

                                        <div class="title_left">
                                            <h3>Ubicación</h3>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="idProvincia">Provincia
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <select class="selectpicker show-menu-arrow form-control ubicacion"
                                                    required="required" id="idProvincia" name="idProvincia" type='select'>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="idCanton">Canton
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <select class="selectpicker show-menu-arrow form-control ubicacion"
                                                    required="required" id="idCanton" name="idCanton" type='select'>

                                                </select>
                                            </div>

                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="idDistrito">Distrito
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <select class="selectpicker show-menu-arrow form-control ubicacion"
                                                    required="required" id="idDistrito" name="idDistrito" type='select'></select>
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="idBarrio">Barrio</label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <select class="selectpicker show-menu-arrow form-control ubicacion" id="idBarrio"
                                                    name="idBarrio" type='select'></select>
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="otrasSenas">Otras
                                                Señas
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="otrasSenas" class="form-control col-md-7 col-xs-12"
                                                    data-validate-length-range="5,160" name="otrasSenas" required="required"
                                                    type="text" placeholder="Mínimo 5 caracteres">
                                            </div>
                                        </div>

                                        <div class="title_left">
                                            <h3>Contacto</h3>
                                        </div>

                                        <div class="ln_solid"></div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="numTelefono">Número
                                                de Teléfono</label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="numTelefono" class="form-control col-md-7 col-xs-12" pattern="^[0-9]+$"
                                                    data-validate-length-range="8,20" name="numTelefono" required="required"
                                                    type="text" placeholder="8 digitos, sin espacios y sin guiones.">
                                            </div>
                                        </div>

                                        <div class="item form-group">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="correoElectronico">Correo
                                                Electrónico
                                                <span class="required">*</span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                <input id="correoElectronico" class="form-control col-md-7 col-xs-12"
                                                    required name="correoElectronico" type="email" required>
                                            </div>
                                        </div>

                                        <div class="ln_solid"></div>

                                        <div class="form-group">
                                            <div class="col-md-6 col-md-offset-3">
                                                <button type="reset" class="btn btn-primary" id="borraCliente">Limpiar</button>
                                                <button id="btnSubmit" type="submit" class="btn btn-success">Aceptar</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <!--  /CONTENIDO DE LA PAGINA -->
                        </div>
                    </div>
                </div>
                <!-- /////////////////////////////////////////////////////// 
                                        Fin de Form Cliente
                /////////////////////////////////////////////////////// -->
            </div>
            <div class="modal-footer">
                <div id="btn-formapago">
                </div>
            </div>
        </div>
    </div>
    <!-- modals -->
    <!-- Large modal -->

    <!-- modals Cargando -->
    <div class="modal modalLoad"> </div>


    <!-- Modal Configuracion de Factura -->
    <div class="modal fade" id="modalConfiguracionFactura" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Configurar Factura</h4>
                </div>

                <div class="modal-body" style="height: calc(50vh - 210px);">
                    <div class="row">
                        <h2>Facturar Productos o Servicios</h2>
                        <!-- <p>The form below contains three inline radio buttons:</p> -->
                        <form>
                            <div class="item form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="radio-inline">
                                        <label class="">
                                            <div class="iradio_flat-green"><input id="rd_productos" type="radio" class="flat"
                                                    checked value="1" name="iCheck">
                                                <ins class="iCheck-helper"></ins></div> Productos
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="item form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="radio-inline">
                                        <label class="">
                                            <div class="iradio_flat-green"><input id="rd_servicios" type="radio" class="flat"
                                                    name="iCheck" value="7">
                                                <ins class="iCheck-helper"></ins></div> Servicios
                                        </label>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                    <br>
                    <div class="row">
                        <h2>Incluir Impuestos de Venta</h2>
                        <!-- <p>The form below contains three inline radio buttons:</p> -->
                        <form>
                            <div class="item form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="radio-inline">
                                        <label class="">
                                            <div class="iradio_flat-green "><input id="rd_conImpuestos" type="radio"
                                                    class="flat" checked value="conImpuestos" name="iCheck">
                                                <ins class="iCheck-helper"></ins></div> Con Impuestos
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="item form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="radio-inline">
                                        <label class="">
                                            <div class="iradio_flat-green "><input id="rd_sinImpuestos" type="radio"
                                                    class="flat" value="sinImpuestos" name="iCheck">
                                                <ins class="iCheck-helper"></ins></div> Sin Impuestos
                                        </label>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Aplicar</button>
                </div>
            </div>

        </div>
    </div>


    <!-- jQuery -->
    <script src="vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- Font Awesome -->
    <link href="vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- FastClick -->
    <script src="vendors/fastclick/lib/fastclick.js"></script>
    <!-- NProgress -->
    <script src="vendors/nprogress/nprogress.js"></script>
    <!-- iCheck -->
    <script src="vendors/iCheck/icheck.min.js"></script>
    <!-- Validator -->
    <script src="assets/js/validator.min.js"></script>
    <!-- Select -->
    <script src="vendors/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <!-- Custom Theme Scripts -->
    <script src="assets/js/custom.min.js"></script>
    <!-- Input mask -->
    <script src="vendors/jquery.inputmask/dist/min/jquery.inputmask.bundle.min.js"></script>
    <!-- JS Scripts -->
    <script src="assets/js/producto.min.js"></script>
    <script src="assets/js/factura.js"></script>
    <script src="assets/js/receptor.min.js"></script>
    <!-- JS dataTables -->
    <script src="vendors/datatables.net/DataTables-1.10.18/js/jquery.dataTables.min.js"></script>
    <script src="vendors/datatables.net/DataTables-1.10.18/js/dataTables.bootstrap.min.js"></script>
    <!-- JS Moments -->
    <script src="vendors/moment/min/moment.min.js"></script>
    <!-- Sweet Alert -->
    <script src="vendors/sweetalert2/dist/sweetalert2.min.js"></script>
    <!-- hotkeys -->
    <script src="vendors/jquery.hotkeys/jquery.hotkeys.js"></script>
    <!-- Switchery -->
    <!-- <script src="vendors/switchery/dist/switchery.min.js"></script> -->
</body>

</html>

<script>
    var t = []; //Tabla 
    var counter = 1; //contador de pruebas para simular id de producto
    var editor; // use a global for the submit and return data rendering in the examples

    $(document).ready(function () {
        // clasificacion de impuestos.
        // factura.checkProfileContribuyente(); no se si se usa.
        $(".call_idDocumento").text(session.idDocumento == 1 ? 'Factura Electrónica' : 'Tiquete Electrónico');
        $(".call_clasificacion").text(session.clasificacion == 1 ? 'Productos' : 'Servicios');
        if(session.clasificacion == 1){
            $('#rd_conImpuestos').attr('checked', true);
            $('#rd_sinImpuestos').attr('checked', false);
            $('#rd_productos').attr('checked', true);
            $('#rd_servicios').attr('checked', false);
            $("#iv_100").html("13%");
            //calcTotal();
        }            
        else {
            $('#rd_conImpuestos').attr('checked', false);
            $('#rd_sinImpuestos').attr('checked', true);
            $('#rd_productos').attr('checked', false);
            $('#rd_servicios').attr('checked', true);
            $("#iv_100").html("0%");
            //calcTotal();
        }


        $('#btn_OpenModalConfiguracion').click(function () {
            $("#modalConfiguracionFactura").modal("show");
        });

        $('#rd_conImpuestos').on('ifChecked', function () {
            $("#iv_100").html("13%");
            calcTotal();
        });

        $('#rd_conImpuestos').on('ifUnchecked', function () {
            $("#iv_100").html("0%");
            calcTotal();
        });

        $('#rd_productos').on('ifUnchecked', function () {
            $("#clasificacion").html("Producto");
            factura.clasificacion = 0;
        });

        $('#rd_servicios').on('ifChecked', function () {
            $("#clasificacion").html("Servicio");
            factura.clasificacion = 1;
        });

        $('.rd_conImpuestos').change(function () {
            if (this.value == 'conImpuestos') {
                $("#iv_100").html("13%");
            } else if (this.value == 'sinImpuestos') {
                $("#iv_100").html("0%");
            }
            calcTotal();
        });

        $body = $("body");
        $(function () {
            $(document)
                .ajaxStart(NProgress.start)
                .ajaxStop(NProgress.done);
        });

        receptor.init();
        receptor.readAllTipoIdentificacion;
        receptor.readAllUbicacion;
        $("#fecha").append(moment().format('MMM DD YYYY, h:mm:ss a'));
        $('#btn_open_modal_fac').attr("disabled", true);
        $('#reload').click(function () {
            location.reload();
        });

        //Usa la variable t que es el datatable donde estan los productos
        t = $('#prd').DataTable({
            responsive: true,
            "ordering": false,
            destroy: true,
            searching: false,
            // "bSort": false,
            // "scrollY": "190px",
            // "searching": false,
            //"scrollCollapse": true,
            "paging": false,
            "info": false, //Quita el pie de pagina
            "language": {
                "infoEmpty": "No hay productos agregados",
                "emptyTable": "No hay productos agregados",
                "search": "Buscar En Factura" //Cambia el texto de Search
            },
            columns: [{
                title: "Descripcion"
            },
            {
                title: "Precio/U",
                "searchable": false,
                "width": "8%",
                mRender: function (e) {
                    return '¢' + parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,
                        ",")
                }
            },
            {
                title: "Cantidad",
                "searchable": false,
                "width": "8%",
                data: null,
                mRender: function () {
                    return `<div class="form-group">
                                    <div class="input-group">
                                        <div class="input-group-btn">
                                            <button id="down" class="btn btn-default prd-cant-sub" ><span class="glyphicon glyphicon-minus"></span></button>
                                        </div>
                                        <input type="text" id="inp-prd-cant" class="form-control input-number inp-prd-cant" value="1" style="width: 4em;" />
                                        <div class="input-group-btn">
                                            <button id="up" class="btn btn-default prd-cant-add"><span class="glyphicon glyphicon-plus"></span></button>
                                        </div>
                                    </div>
                                </div>`
                }
            },
            {
                title: "Importe",
                "searchable": false,
                "width": "8%",
                mRender: function (e) {
                    return '¢' + parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,
                        ",")
                }
            },
            {
                title: "Acción",
                "searchable": false,
                "width": "8%",
                data: null,
                className: "center",
                defaultContent: '<button class="btn-link remove"><i class="fa fa-trash" aria-hidden="true">  Eliminar</i></button>'
            }
            ]
        });

        t.columns.adjust().draw();

        // hot keys  // Si precionan enter el focus se va al precio y no a descripcion
        $(document).bind('keydown', 'f2', abrirModalPago);
        $('#inp_descripcion').bind('keydown', 'f2', abrirModalPago);
        $('#inp_precio').bind('keydown', 'f2', abrirModalPago);
        $(document).bind('keydown', 'f4', btn_open_modal_agregar_cliente);
        $('#inp_descripcion').bind('keydown', 'f4', btn_open_modal_agregar_cliente);
        $('#inp_precio').bind('keydown', 'f4', btn_open_modal_agregar_cliente);
        $('#inp_precio').on('keyup', function (e) {
            //Valida que al presionar enter la descripcion y el precio no este en blanco
            var keyCode = e.keyCode || e.which;            
            if (keyCode === 13 && ($('#inp_precio').val().length) > 0 && ($('#inp_descripcion').val().length) > 0) { //Valida que sea enter y que no este vacio el precio
                agregarProducto();
            }
            //Si la descripcion esta en blanco no permite agregar el producto y lo retorna a la descripcion
            if (keyCode === 13 && ($('#inp_descripcion').val().length) < 1){                
                $("#inp_descripcion").focus();
            }
        });

        $('#inp_descripcion').on('keyup', function (e) {
            var keyCode = e.keyCode || e.which;
            if (keyCode === 13) {
                $("#inp_precio").focus();
            }
        });

        $('#pagocash').on('keyup', function (e) {
            var keyCode = e.keyCode || e.which;
            if (keyCode === 13) {
                CreateFact();
            }
        });

        $("#inp_descripcion").focus();

    });

    $('#btn_agregarProducto').click(function () {
        agregarProducto();
    });


    //Abre modal de modo de pago
    $('#btn_open_modal_fac').click(function () {
        abrirModalPago();
    });

    //Abre modal de Agregar Cliente
    function btn_open_modal_agregar_cliente() {      
        $(".seleccionar-cliente-modal-lg").modal("show");
        $("#lbl_cedulaReceptor").focus();
    };

    $('#btn_Cerrar_seleccionar-cliente-modal-lg').click(function () {
        $(".seleccionar-cliente-modal-lg").modal("hide");
    });

    $(".validar_agregar").keyup(function () {
        if ($("#inp_precio").val() != "" && $("#inp_descripcion").val() != "") {
            $("#btn_agregarProducto").removeAttr("disabled");
        } else {
            $('#btn_agregarProducto').attr('disabled', 'disabled');
        }
    });

    $('#prd').on("click", ".prd-cant-add", function () {
        var cantidad = $(this)[0].parentElement.parentElement.children[1]; 
        var fila = t.row($(this).parents('tr')).data();       
        cantidad.value  = parseInt(cantidad.value) + 1;
        if (parseInt(cantidad.value) >= 9999) {
            cantidad.value = 9999;
        }
        var nuevoImporte = fila[1] *  cantidad.value;
        t.cell(t.row($(this).parents('tr')), 3).data(nuevoImporte).draw(); 
        calcTotal();


    });

    $('#prd').on("click", ".prd-cant-sub", function () {
        var cantidad = $(this)[0].parentElement.parentElement.children[1];        
        var fila = t.row($(this).parents('tr')).data();
        cantidad.value  = parseInt(cantidad.value) - 1;
        if (parseInt(cantidad.value) <= 1) {
            cantidad.value = 1;
        }
        var nuevoImporte = fila[1] *  cantidad.value;
        t.cell(t.row($(this).parents('tr')), 3).data(nuevoImporte).draw(); 
        calcTotal();
        
    });

    $('#prd').on('click', 'prd_cant', function (e) {
        var fila = t.row($(this).parents('tr')).data();
        var nuevoImporte = fila[1] * this.value;
        t.cell(t.row($(this).parents('tr')), 3).data(nuevoImporte).draw();
        calcTotal();
    });

    $('#btn_buscarReceptor').click(function () {
        receptor.readIdentificacionReceptor;
    });

    $("#lbl_cedulaReceptor").keyup(function (event) {
        if (event.keyCode === 13) {
            receptor.readIdentificacionReceptor;
        }
    });

    $('#prd').on("click", ".remove", function () {
        t.row($(this).parents('tr')).remove().draw(false);
        calcTotal();
    });

    $('#borraCliente').click(function () {
        receptor.id = null;
    });

</script>